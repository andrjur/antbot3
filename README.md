# AntBot - Telegram-–±–æ—Ç –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∫—É—Ä—Å–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ

AntBot - —ç—Ç–æ –º–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∫—É—Ä—Å–∞–º–∏. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫—É—Ä—Å—ã, –ø–æ–ª—É—á–∞—Ç—å —É—Ä–æ–∫–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É (–≤ —Ç–æ–º —á–∏—Å–ª–µ —Å –ø–æ–º–æ—â—å—é AI) –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å–æ —Å–ª—É–∂–±–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

--- 

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- **–ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫—É—Ä—Å–æ–≤:** –ü—Ä–æ—Å—Ç–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫—É—Ä—Å—É —Å –ø–æ–º–æ—â—å—é —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞.
- **–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–∫–æ–≤:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —É—Ä–æ–∫–æ–≤ –∏–∑ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ Telegram-–∫–∞–Ω–∞–ª–∞ –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∏ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫.
- **–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π:** –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É.
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** –ü—Ä—è–º–∞—è –ª–∏–Ω–∏—è —Å–≤—è–∑–∏ —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ –∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞.

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏:** –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—É—Ä—Å–æ–≤, —É—Ä–æ–∫–æ–≤ –∏ —Ç–∞—Ä–∏—Ñ–æ–≤ (–≤–µ—Ä—Å–∏–π –∫—É—Ä—Å–∞).
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –∞–¥–º–∏–Ω-–≥—Ä—É–ø–ø–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏.
- **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è:** –û—Ç–≤–µ—Ç—ã –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–µ–∂–∏–º–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å n8n:** –í–µ–±—Ö—É–∫–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–∏—Å–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ n8n –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –î–ó –∏ –æ—Ç–≤–µ—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä—Ç–æ–≤.

--- 

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤ `requirements.txt`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone https://github.com/andrjur/antbot3
    cd antbot3
    ```

2.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
    –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –ø—Ä–∏–º–µ—Ä—É `.env.example` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
    ```env
    # –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞
    BOT_TOKEN=123456:ABC-DEF1234567890

    # ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
    ADMIN_IDS=777000,123456

    # ID –æ—Å–Ω–æ–≤–Ω–æ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–æ–π –≥—Ä—É–ø–ø—ã
    ADMIN_GROUP_ID=-1001234567890

    # URL –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤ n8n
    N8N_HOMEWORK_CHECK_URL=https://your-n8n-instance.com/webhook/homework-check
    N8N_ASK_EXPERT_URL=https://your-n8n-instance.com/webhook/ask-expert

    # –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–µ–±—Ö—É–∫–æ–≤
    N8N_WEBHOOK_SECRET=your_secret_for_outgoing_webhooks
    N8N_CALLBACK_SECRET=your_secret_for_incoming_callbacks

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
    BASE_WEBHOOK_URL=https://your-domain.com
    WEBHOOK_SECRET_TOKEN=your_super_secret_token_for_telegram
    WEB_SERVER_PORT=8080
    ```

4.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫—É—Ä—Å—ã:**
    –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `settings.json`, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à–∏ –∫—É—Ä—Å—ã, —Ç–∞—Ä–∏—Ñ—ã –∏ –∫–æ–¥—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.

5.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
    ```bash
    python main.py
    ```

--- 

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### –†–∞–∑–º–µ—Ç–∫–∞ —É—Ä–æ–∫–æ–≤ –≤ –∫–∞–Ω–∞–ª–µ

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –±–æ—Ç –º–æ–≥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–∞—Ä—Å–∏—Ç—å —É—Ä–æ–∫–∏ –∏–∑ –≤–∞—à–µ–≥–æ Telegram-–∫–∞–Ω–∞–ª–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Ä–∞–∑–º–µ—Ç–∫—É. –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —É—Ä–æ–∫–æ–º –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏.

**–ü—Ä–∏–º–µ—Ä —Ä–∞–∑–º–µ—Ç–∫–∏:**

```
*START_LESSON 1*
–¢–µ–∫—Å—Ç –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–∫–∞...
*END_LESSON 1*
```

```
*START_LESSON 2*
–¢–µ–∫—Å—Ç –≤—Ç–æ—Ä–æ–≥–æ —É—Ä–æ–∫–∞...
*HW_START*
–¢–µ–∫—Å—Ç –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è...
*HW_END*
*END_LESSON 2*
```

- `*START_LESSON <–Ω–æ–º–µ—Ä>*`: –ù–∞—á–∞–ª–æ –±–ª–æ–∫–∞ —É—Ä–æ–∫–∞.
- `*END_LESSON <–Ω–æ–º–µ—Ä>*`: –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ —É—Ä–æ–∫–∞.
- `*HW_START*`: –ù–∞—á–∞–ª–æ –±–ª–æ–∫–∞ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è.
- `*HW_END*`: –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è.
- `*COURSE_END*`: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–µ–≥, –∫–æ—Ç–æ—Ä—ã–π –æ–∑–Ω–∞—á–∞–µ—Ç –∫–æ–Ω–µ—Ü –≤—Å–µ–≥–æ –∫—É—Ä—Å–∞. –ï–≥–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∫—É—Ä—Å–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫—É—Ä—Å–æ–≤ (`settings.json`)

–≠—Ç–æ—Ç —Ñ–∞–π–ª —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–∏–º–∏ –∫—É—Ä—Å–∞–º–∏.

- **`groups`**: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ ID –∫–∞–Ω–∞–ª–æ–≤ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –∏ –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–π.
- **`tariff_names`**: –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –≤–µ—Ä—Å–∏–π –∫—É—Ä—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `v1: "–ë–∞–∑–æ–≤—ã–π"`).
- **`activation_codes`**: –°–ª–æ–≤–∞-–∫–ª—é—á–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫—É—Ä—Å–æ–≤, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫—É—Ä—Å—É, —Ç–∞—Ä–∏—Ñ—É –∏ —Ü–µ–Ω–µ.

--- 

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–¥–∏–Ω –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª `main.py`. –í –ø–ª–∞–Ω–∞—Ö –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

```
. 
‚îú‚îÄ‚îÄ .env # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ bot.db # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite
‚îú‚îÄ‚îÄ main.py # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
‚îú‚îÄ‚îÄ populate_tasks.py # –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î
‚îú‚îÄ‚îÄ README.md # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ requirements.txt # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ settings.json # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—É—Ä—Å–æ–≤
```

---

## üî¨ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π (`main.py`)

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –±–æ—Ç–µ.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

- **`setup_logging()`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å–æ–±—ã—Ç–∏–π –≤ —Ñ–∞–π–ª `bot.log` –∏ –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `RotatingFileHandler` –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ 500 –ö–ë. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π `LocalTimeFormatter` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ 'Europe/Moscow'.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞.

- **`load_settings()`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞ `settings.json`. –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç `populate_course_versions()` –¥–ª—è –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å —Ç–∞—Ä–∏—Ñ–∞–º–∏.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `main()`.

- **`init_db()`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `bot.db`. –°–æ–∑–¥–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã (`users`, `courses`, `user_courses`, `group_messages` –∏ –¥—Ä.), –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `PRAGMA journal_mode = WAL` –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `main()`.

### –†–∞–±–æ—Ç–∞ —Å –∫—É—Ä—Å–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

- **`activate_course(user_id, activation_code, level)`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∫—É—Ä—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–æ–¥–æ–≤–æ–º—É —Å–ª–æ–≤—É. –õ–æ–≥–∏–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç:
    1.  –ü–æ–∏—Å–∫ –∫–æ–¥–∞ –≤ –ë–î.
    2.  –ü—Ä–æ–≤–µ—Ä–∫—É, –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∞–∫—Ç–∏–≤–Ω—ã–π –∫—É—Ä—Å.
    3.  –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω —Ç–æ—Ç –∂–µ —Ç–∞—Ä–∏—Ñ ‚Äî —Å–æ–æ–±—â–∞–µ—Ç –æ–± —ç—Ç–æ–º.
    4.  –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω –¥—Ä—É–≥–æ–π —Ç–∞—Ä–∏—Ñ ‚Äî –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Å–º–µ–Ω—É —Ç–∞—Ä–∏—Ñ–∞, —Å–±—Ä–∞—Å—ã–≤–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å.
    5.  –ï—Å–ª–∏ –∫—É—Ä—Å –±—ã–ª –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω ‚Äî –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –µ–≥–æ.
    6.  –õ–æ–≥–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã `/activate`.

- **`deactivate_course(user_id, course_id)`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∫—É—Ä—Å–∞ 'inactive' –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–ª—è –Ω–µ–≥–æ –∑–∞–¥–∞—á—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É—Ä–æ–∫–æ–≤ (`stop_lesson_schedule_task`).
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–ª–±—ç–∫–∞ `stop_course`.

- **`send_lesson_to_user(user_id, course_id, lesson_num, repeat, level)`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É—Ä–æ–∫–æ–≤.
    1.  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —É—Ä–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–º. –ï—Å–ª–∏ –¥–∞ ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `_handle_course_completion`.
    2.  –ü–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —É—Ä–æ–∫–∞ –∏–∑ –ë–î (`_get_lesson_content_from_db`).
    3.  –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ —á–∞—Å—Ç–∏ —É—Ä–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (`_send_lesson_parts`), –ø—Ä–æ–ø—É—Å–∫–∞—è —Ç–µ, —á—Ç–æ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É—Ä–æ–≤–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    4.  –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î (`_update_user_course_after_lesson`).
    5.  –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** `check_lesson_schedule()` (–æ—Å–Ω–æ–≤–Ω–æ–π –≤—ã–∑–æ–≤), –∞ —Ç–∞–∫–∂–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–≤—Ç–æ—Ä–∞ —É—Ä–æ–∫–æ–≤.

- **`check_lesson_schedule(user_id, hours, minutes)`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ—Ä–∞ –ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
    1.  –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—É—Ä—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    2.  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –æ–∂–∏–¥–∞–µ—Ç –ª–∏ –±–æ—Ç –¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ (`hw_status`).
    3.  –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–∫–∞ –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.
    4.  –ï—Å–ª–∏ –≤—Ä–µ–º—è –ø—Ä–∏—à–ª–æ ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `send_lesson_to_user`.
    5.  –ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ –ø—Ä–∏—à–ª–æ ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –º–µ–Ω—é, –ø–æ–∫–∞–∑—ã–≤–∞—è, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** `scheduled_lesson_check()`, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π (FSM)

- **`start(message: Message, state: FSMContext)`**
  - **–ö–æ–º–∞–Ω–¥–∞:** `/start`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ –¥–∞–Ω–Ω—ã–µ. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (`send_main_menu_for_user`), –≤ –∫–æ—Ç–æ—Ä–æ–º –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π.

- **`show_my_courses(message: Message)`**
  - **–ö–æ–º–∞–Ω–¥–∞:** `/mycourses`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–ø–∏—Å–æ–∫ –µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–ø–µ—Ä–µ–π—Ç–∏ –∫ –∫—É—Ä—Å—É, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ).

- **`activate_command(message: Message, state: FSMContext)`**
  - **–ö–æ–º–∞–Ω–¥–∞:** `/activate`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –ø–µ—Ä–µ–≤–æ–¥—è –µ–≥–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `waiting_for_activation_code`.

- **`process_activation_code(message: Message, state: FSMContext)`**
  - **–°–æ—Å—Ç–æ—è–Ω–∏–µ:** `waiting_for_activation_code`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∞–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—ã–π –∫–æ–¥, –≤—ã–∑—ã–≤–∞–µ—Ç `activate_course()` –¥–ª—è –µ–≥–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

- **`cmd_support_callback(query: CallbackQuery, state: FSMContext)`**
  - **–ö–æ–ª–±—ç–∫:** `menu_support`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `SupportRequest.waiting_for_message`, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

- **`process_support_message(message: Message, state: FSMContext)`**
  - **–°–æ—Å—Ç–æ—è–Ω–∏–µ:** `SupportRequest.waiting_for_message`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫—É—é –≥—Ä—É–ø–ø—É, –¥–æ–±–∞–≤–ª—è—è –∫ –Ω–µ–º—É –∫–Ω–æ–ø–∫—É "–û—Ç–≤–µ—Ç–∏—Ç—å".

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π

- **`process_homework(message: Message, state: FSMContext)`**
  - **–°–æ—Å—Ç–æ—è–Ω–∏–µ:** `AwaitingHomework.waiting_for_homework`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –µ–≥–æ –≤ –∞–¥–º–∏–Ω-–≥—Ä—É–ø–ø—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —Å–Ω–∞–±–¥–∏–≤ –∫–Ω–æ–ø–∫–∞–º–∏ "–ü—Ä–∏–Ω—è—Ç—å" –∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å". –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ n8n —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫ `N8N_HOMEWORK_CHECK_URL` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.

- **`cb_admin_approve_hw(query: CallbackQuery, callback_data: AdminHomeworkCallback)`**
  - **–ö–æ–ª–±—ç–∫:** `admin_hw:approve_hw`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∞–¥–º–∏–Ω–æ–º –∫–Ω–æ–ø–∫–∏ "–ü—Ä–∏–Ω—è—Ç—å". –í—ã–∑—ã–≤–∞–µ—Ç `handle_homework_result()` —Å —Ñ–ª–∞–≥–æ–º `is_approved=True`.

- **`handle_homework_result(user_id, course_id, ..., is_approved, ...)`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –î–ó (–∫–∞–∫ –æ—Ç –∞–¥–º–∏–Ω–∞, —Ç–∞–∫ –∏ –æ—Ç n8n). 
    1.  –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –ø—Ä–∏–Ω—è—Ç–æ –µ–≥–æ –î–ó –∏–ª–∏ –Ω–µ—Ç, –≤–º–µ—Å—Ç–µ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º.
    2.  –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –î–ó (`hw_status`) –≤ –ë–î –Ω–∞ `approved` –∏–ª–∏ `rejected`.
    3.  –ï—Å–ª–∏ –î–ó –ø—Ä–∏–Ω—è—Ç–æ, –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (`check_lesson_schedule`), —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫.
    4.  –£–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑ –∞–¥–º–∏–Ω-—á–∞—Ç–∞.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** `cb_admin_approve_hw`, `cb_admin_reject_hw`, `handle_n8n_hw_approval`.

- **`handle_n8n_hw_approval(request: web.Request)`**
  - **–í–µ–±—Ö—É–∫:** `/n8n_hw_approval`
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –î–ó –æ—Ç n8n. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –∞–¥–º–∏–Ω–æ–º, –≤—ã–∑—ã–≤–∞–µ—Ç `handle_homework_result` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ï—Å–ª–∏ –∞–¥–º–∏–Ω —É–∂–µ –Ω–∞—á–∞–ª –ø—Ä–æ–≤–µ—Ä–∫—É, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç AI –∫–∞–∫ –ø–æ–¥—Å–∫–∞–∑–∫—É –≤ —Ç—Ä–µ–¥.

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ–±—Ö—É–∫–∏

- **`admin_panel(message: Message)`**
  - **–ö–æ–º–∞–Ω–¥–∞:** `/admin` (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–Ω–µ–ª—å —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.

- **`process_new_content(message: Message)`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º. –û–Ω –ø–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∏—â–µ—Ç —Ç–µ–≥–∏ (`*START_LESSON*`, `*HW_START*` –∏ —Ç.–¥.) –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —É—Ä–æ–∫–æ–≤ –∏ –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (`group_messages`).
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª–∞—Ö, ID –∫–æ—Ç–æ—Ä—ã—Ö —É–∫–∞–∑–∞–Ω—ã –≤ `settings.json`.

- **`require_n8n_secret(handler)`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å–µ–∫—Ä–µ—Ç–∞ (`N8N_CALLBACK_SECRET`) –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∑–∞–ø—Ä–æ—Å–∞. –ó–∞—â–∏—â–∞–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —Ñ—É–Ω–∫—Ü–∏—è–º-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç n8n (`handle_n8n_hw_approval`, `handle_n8n_expert_answer`).

- **`main()`**
  - **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ì–ª–∞–≤–Ω–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∑–∞–ø—É—Å–∫–∞—é—â–∞—è –±–æ—Ç–∞. –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
    1.  –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
    2.  –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.
    3.  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (`init_db`).
    4.  –ó–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (`load_settings`).
    5.  –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤–µ–±-—Å–µ—Ä–≤–µ—Ä `aiohttp` –¥–ª—è –ø—Ä–∏–µ–º–∞ –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç Telegram –∏ n8n.
    6.  –ó–∞–ø—É—Å–∫–∞–µ—Ç `dp.start_polling()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç Telegram.
  - **–û—Ç–∫—É–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ `python main.py`.

---

## üìä –î–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### 1. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —É—Ä–æ–∫–∞

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∫—É—Ä—Å] --> B{–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è};
    B -->|–í—Ä–µ–º—è –ø—Ä–∏—à–ª–æ| C[send_lesson_to_user];
    C --> D{–£—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –î–ó?};
    D -->|–î–∞| E[–û–±–Ω–æ–≤–∏—Ç—å hw_status='pending'];
    D -->|–ù–µ—Ç| F[–û–±–Ω–æ–≤–∏—Ç—å current_lesson];
    F --> B;
    E --> G[–û–∂–∏–¥–∞–Ω–∏–µ –î–ó –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è];
    G --> H[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–¥–∞–µ—Ç –î–ó];
    H --> I{–ü—Ä–æ–≤–µ—Ä–∫–∞ –î–ó};
    I -->|–ü—Ä–∏–Ω—è—Ç–æ| J[–û–±–Ω–æ–≤–∏—Ç—å hw_status='approved'];
    J --> B;
    I -->|–û—Ç–∫–ª–æ–Ω–µ–Ω–æ| K[–û–±–Ω–æ–≤–∏—Ç—å hw_status='rejected'];
    K --> G;
```

### 2. –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è

```mermaid
sequenceDiagram
    participant User as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant Bot as –ë–æ—Ç
    participant AdminGroup as –ê–¥–º–∏–Ω-–≥—Ä—É–ø–ø–∞
    participant N8N as n8n.io

    User->>Bot: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –î–ó
    Bot->>AdminGroup: –ü–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –î–ó —Å –∫–Ω–æ–ø–∫–∞–º–∏
    Bot->>N8N: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –î–ó –Ω–∞ –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫—É (–≤–µ–±—Ö—É–∫)
    alt –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
        AdminGroup->>Bot: –ê–¥–º–∏–Ω –Ω–∞–∂–∏–º–∞–µ—Ç "–ü—Ä–∏–Ω—è—Ç—å"
        Bot->>User: ‚úÖ –î–ó –ø—Ä–∏–Ω—è—Ç–æ!
        Bot-->>AdminGroup: –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ (—É–±–∏—Ä–∞–µ—Ç –∫–Ω–æ–ø–∫–∏)
        Bot->>Bot: –ó–∞–ø—É—Å–∫–∞–µ—Ç check_lesson_schedule
    else AI-–ø—Ä–æ–≤–µ—Ä–∫–∞
        N8N-->>Bot: –ü—Ä–∏—Å—ã–ª–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–≤–µ–±—Ö—É–∫)
        alt –î–ó –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∞–¥–º–∏–Ω–æ–º
            Bot->>User: ü§ñ AI –ø—Ä–æ–≤–µ—Ä–∏–ª: –î–ó –ø—Ä–∏–Ω—è—Ç–æ!
            Bot-->>AdminGroup: –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
            Bot->>Bot: –ó–∞–ø—É—Å–∫–∞–µ—Ç check_lesson_schedule
        else –î–ó –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∞–¥–º–∏–Ω–æ–º
            Bot-->>AdminGroup: ü§´ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫—É –æ—Ç AI –∞–¥–º–∏–Ω—É
        end
    end
```

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT.

---

## üßê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ –∏ —Ç–æ—á–∫–∏ —Ä–æ—Å—Ç–∞

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤. –ó–¥–µ—Å—å –æ–ø–∏—Å–∞–Ω—ã —Ç–µ–∫—É—â–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –∏—Ö –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é.

### –°–ø–æ—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ "—É–∑–∫–∏–µ –º–µ—Å—Ç–∞"

1.  **–ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π `main.py`:** –í—Å–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã, —É—Ç–∏–ª–∏—Ç—ã –∏ –ª–æ–≥–∏–∫–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –∑–∞–ø—É—Å–∫, –Ω–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥, —Ä–∞–∑–±–∏–≤ –∫–æ–¥ –Ω–∞ –º–æ–¥—É–ª–∏ (`handlers`, `keyboards`, `db`, `utils`), –∫–∞–∫ –±—ã–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —Ä–∞–Ω–µ–µ.

2.  **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (`settings`, `lesson_check_tasks`) –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ç—Ä—É–¥–Ω–æ–æ—Ç–ª–∞–≤–ª–∏–≤–∞–µ–º—ã–º –æ—à–∏–±–∫–∞–º. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥–∞) —á–µ—Ä–µ–∑ middleware –≤ `aiogram` –∏–ª–∏ —è–≤–Ω–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏.

3.  **–ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ RegEx:** –§—É–Ω–∫—Ü–∏—è `process_new_content` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —É—Ä–æ–∫–æ–≤. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ö—Ä—É–ø–∫–æ. –û–ø–µ—á–∞—Ç–∫–∞ –≤ —Ç–µ–≥–µ `*START_LESSON*` –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –∏–º–ø–æ—Ä—Ç. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π —Ñ–æ—Ä–º–∞—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, JSON –∏–ª–∏ YAML, –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫—É—Ä—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –∫–æ–º–∞–Ω–¥—É.

4.  **–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** `scheduled_lesson_check` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ `asyncio` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –Ω–æ –æ–Ω–æ –ø–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `apscheduler`), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É –ø—Ä–æ–≤–µ—Ä—è–µ—Ç *–≤—Å–µ—Ö* –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ–≥–æ –ø–æ–¥–æ—à–ª–æ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É—Ä–æ–∫–∞.

5.  **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –î–ó –≤ –ø–∞–º—è—Ç–∏:** –°–ª–æ–≤–∞—Ä—å `HOMEWORK_BEING_PROCESSED` –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö –î–ó —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏. –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–µ—Ä—è–µ—Ç—Å—è. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ –ë–î, –¥–æ–±–∞–≤–∏–≤ –ø–æ–ª–µ `locked_by_admin_id` –∏ `locked_at` –≤ —Ç–∞–±–ª–∏—Ü—É `pending_admin_homework`.

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø–ª–∞–Ω –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

- **–î–æ 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
  - **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ `SQLite` + `asyncio` —Å–ø—Ä–∞–≤–∏—Ç—Å—è –±–µ–∑ –ø—Ä–æ–±–ª–µ–º. –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ ‚Äî I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ Telegram API.
  - **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

- **100 - 5,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
  - **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** `SQLite` –Ω–∞—á–Ω–µ—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è "—É–∑–∫–∏–º –º–µ—Å—Ç–æ–º", –æ—Å–æ–±–µ–Ω–Ω–æ –∏–∑-–∑–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –Ω–∞ –∑–∞–ø–∏—Å—å (`database is locked`). –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á `scheduled_lesson_check` –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –∑–∞–º–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏.
  - **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
    1.  **–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ PostgreSQL:** –ó–∞–º–µ–Ω–∏—Ç—å `aiosqlite` –Ω–∞ `asyncpg`. PostgreSQL –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∏ –∑–∞–ø–∏—Å—å—é.
    2.  **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:** –ó–∞–º–µ–Ω–∏—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞ `apscheduler`.

- **5,000 - 50,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
  - **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –û–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å –±–æ—Ç–∞ –º–æ–∂–µ—Ç –Ω–µ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ä–∞—Å—Å—ã–ª–æ–∫. Telegram API –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫–∏ `429 Too Many Requests`.
  - **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
    1.  **–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (Celery/Redis):** –í—ã–Ω–µ—Å—Ç–∏ —Ç—è–∂–µ–ª—ã–µ –∏–ª–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ñ–æ–Ω–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã. –ö–∞–Ω–¥–∏–¥–∞—Ç—ã:
        - –†–∞—Å—Å—ã–ª–∫–∞ —É—Ä–æ–∫–æ–≤ (`send_lesson_to_user`).
        - –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ –≤–Ω–µ—à–Ω–∏–º API (n8n).
        - –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤.
    2.  **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–æ–≤), —á—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ë–î.

- **–ë–æ–ª–µ–µ 100,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
  - **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç —Å–≤–æ–µ–≥–æ –ø—Ä–µ–¥–µ–ª–∞. –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ.
  - **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã):**
    1.  **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã:** –†–∞—Å–ø–∏–ª–∏—Ç—å –º–æ–Ω–æ–ª–∏—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –æ–±—â–∞—é—â–∏—Ö—Å—è —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, RabbitMQ –∏–ª–∏ Kafka).
        - **`Gateway Service`:** –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç Telegram, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å.
        - **`Scheduler Service`:** –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–∞—Å—Å—ã–ª–∫—É —É—Ä–æ–∫–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.
        - **`Homework Service`:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–¥–∞—á—É –∏ –ø—Ä–æ–≤–µ—Ä–∫—É –î–ó.
        - **`Core Service`:** –£–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫–æ–π –∫—É—Ä—Å–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç.–¥.
    2.  **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –ë–î (read-replicas) –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —á—Ç–µ–Ω–∏–µ.

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Deployment)

- **–ü—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç (–¥–æ 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
  - –û–¥–∏–Ω –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (VPS).
  - –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ `systemd` —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞.
  - PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ.
  - –î–ª—è –≤–µ–±—Ö—É–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `nginx` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏.

- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–æ—Ç 5000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
  - **Docker –∏ Docker Compose:** –£–ø–∞–∫–æ–≤–∞—Ç—å –±–æ—Ç–∞ –∏ –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (PostgreSQL, Redis) –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. `docker-compose.yml` –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ.
  - **Kubernetes (K8s):** –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏. –ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π `Deployment` –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ K8s, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø—ã—Ç—ã–≤–∞—é—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –Ω–∞–≥—Ä—É–∑–∫—É.
